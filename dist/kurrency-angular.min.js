!function(a,b){"use strict";function c(){a[KURRENCY_CONFIG.ANGULAR].module("KurrencyApp",[]),a[KURRENCY_CONFIG.ANGULAR].module("KurrencyApp").run(["$templateCache",function(a){a.put("kurrency-templates/kurrency-menu.html",'<div class="kurrency-menu" ng-class="{\'logged-in\': kurrency.auth.loggedIn(), \'open\': menuService.showing}">\n  <ul class="menu-wrapper">\n    <li ng-repeat="mi in menuService.menu" ng-show="menuService.checkShowing(mi)" ng-class="menuService.checkButtonClass(mi)">\n      <ng-include src="mi.buttonTemplateUrl"></ng-include>\n    </li>\n  </ul>\n  <div class="kurrency-loading" ng-class="{active: (apiLoading > 0)}"><div class="loading-indicator">Loading...</div></div>\n  <div class="kurrency-sidebar {{sidebar.className}}" ng-repeat="sidebar in menuService.sidebars" ng-class="{active: menuService.show(sidebar.tag)}">\n    <div class="closer">\n      <a href class="back" ng-show="back" ng-click="toggle(back)"><span class="kicon-arrow-left"></span></a>\n      <a href ng-click="close()"><span class="kicon-close"></span></a>\n    </div>\n    <div class="kurrency-container" ng-include="sidebar.templateUrl"></div>\n  </div>\n</div>'),a.put("kurrency-templates/kurrency-popover.html",'<span ng-transclude></span>\n<div class="kurrency-popover">\n  <span ng-bind="kurrencyPopover"></span>\n</div>'),a.put("kurrency-templates/kurrency-product.html",'<div class="kurrency-product">\n  <div class="kurrency-product-container">\n    <kurrency-image src="product.images[0]" options="{size: \'300x200\'}" alt="product.name"></kurrency-image>\n  </div>\n  <div class="kurrency-product-container">\n    <div class="column">\n      <h2 ng-bind="product.name"></h2>\n      <h3 ng-show="product.sub_title" ng-bind="product.sub_title"></h3>\n      <span class="price" ng-bind="product.price / 100 | currency"></span>\n    </div>\n    <div class="column">\n      <div ng-show="product.attributes">\n        <div ng-repeat="variant in product.attributes">\n          <select ng-model="variant.$selected" ng-change="setVariant(variant.name, variant.$selected)" ng-options="option as option.name for option in variant.options"><option value>Select a {{variant.name}}</select>\n        </div>\n      </div>\n      <button type="button" ng-click="addToCart(product, 1)">Buy Now</button>\n    </div>\n    <p ng-bind-html="product.short_description"></p>\n  </div>\n</div>'),a.put("kurrency-templates/menu/account.html",'<h1>My Account</h1>\n<div class="alerts">\n  <div ng-repeat="alert in messages[\'account\']" class="alert-{{alert.type}}">{{alert.message}}</div>\n</div>\n<p>Shipping Addresses</p>\n<ul class="addresses-list">\n  <li class="address" ng-repeat="address in addressList">\n    <div class="clearfix" ng-show="!address.$editing">\n      <div class="left">\n        <div><span ng-bind="address.name | limitTo:18"></span></div>\n        <div><span ng-bind="(address.email | limitTo:18) + \'...\'"></span></div>\n        <div><span ng-bind="address.phone | limitTo:18"></span></div>\n      </div>\n      <div class="right">\n        <div><span ng-bind="address.address.address_1 | limitTo:18"></span></div>\n        <div><span ng-bind="address.address.city + \', \' + address.address.state_code | limitTo:18"></span></div>\n        <div><span ng-bind="address.address.postal_code + \', \' + address.address.country_code"></span></div>\n      </div>\n    </div>\n    <div class="edit-holder" ng-show="address.$editing">\n      <form ng-submit="updateAddress(address)">\n        <input class="kurrency-input" type="text" ng-model="address.name" placeholder="Your Name">\n        <input class="kurrency-input" type="text" ng-model="address.company_name" placeholder="(optional) Company Name">\n        <input class="kurrency-input" type="text" ng-model="address.address.address_1" placeholder="Enter your address" ng-change="lookupGeoCode(address.address.address_1, address.address.postal_code, address)">\n        <div ng-show="geocodeComplete">\n          <input class="kurrency-input" type="text" ng-model="address.address.address_2" placeholder="(optional) Address Line 2">\n          <input class="kurrency-input" type="text" ng-model="address.address.city" placeholder="Enter your city">\n          <select class="kurrency-input" ng-model="address.address.state_code" ng-options="state.value as state.name for state in stateList"><option value>Select a State</option></select>\n          <select class="kurrency-input" ng-model="address.address.country_code" ng-options="country.value as country.name for country in countryList"><option value>Select a Country</option></select>\n        </div>\n        <input class="kurrency-input" type="text" ng-model="address.address.postal_code" placeholder="Enter your postal/zip code" ng-change="lookupGeoCode(address.address.address_1, address.address.postal_code, address)">\n        <button class="kurrency-button small half cancel" ng-click="address.$editing = false">Cancel</button>\n        <button class="kurrency-button small half submit" ng-click="saveAddress(address)">Save</button>\n      </form>\n    </div>\n    <div ng-show="!address.$editing">\n      <button class="kurrency-button small half edit" ng-click="address.$editing = true">Edit</button>\n      <button class="kurrency-button small half delete" ng-click="deleteAddress(address)">Delete</button>\n    </div>\n  </li>\n</ul>\n<p>Payment Methods</p>\n<div class="alerts">\n  <div ng-repeat="alert in messages[\'payment_methods\']" class="alert-{{alert.type}}">{{alert.message}}</div>\n</div>\n<ul class="payment-methods">\n  <li class="payment-method" ng-repeat="payment_method in paymentMethodList">\n    <div class="clearfix" ng-show="!payment_method.$editing">\n      <div class="left" ng-bind="payment_method.nickname"></div>\n      <div class="right" ng-bind="getPaymentMethodType(payment_method)"></div>\n    </div>\n    <div class="edit-holder" ng-show="payment_method.$editing">\n      <form ng-submit="updatePaymentMethod(payment_method)">\n        <input class="kurrency-input" type="text" ng-model="payment_method.nickname" placeholder="Nickname">\n        <button class="kurrency-button small half cancel" ng-click="payment_method.$editing = false">Cancel</button>\n        <button class="kurrency-button small half submit" ng-click="savePaymentMethod(payment_method)">Save</button>\n      </form>\n    </div>\n    <div ng-show="!payment_method.$editing">\n      <button class="kurrency-button small half edit" ng-click="payment_method.$editing = true">Edit</button>\n      <button class="kurrency-button small half delete" ng-click="deletePaymentMethod(payment_method)">Delete</button>\n    </div>\n  </li>\n</ul>'),a.put("kurrency-templates/menu/button-cart.html",'<a ng-click="menuService.toggle(\'cart\')" kurrency-popover="shoppingCartPopoverText" showing="{{cartAddActive}}" ng-class="menuService.checkClass(\'cart\')"><span class="kicon-cart"></span><span class="count">{{quantity_total}}</span></a>'),a.put("kurrency-templates/menu/button.html",'<a ng-href="{{menuService.getUri(mi)}}" ng-click="mi.onClick ? mi.onClick() : menuService.toggle(mi.tag)" kurrency-popover="mi.name" class="menuService.checkClass(mi.tag)"><span class="{{mi.icon}}"></span></a>'),a.put("kurrency-templates/menu/cart.html",'<h1>Shopping Cart</h1>\n<div ng-show="!cart || !cart.length">\n  <p>You have nothing in your cart</p>\n  <button type="button" class="kurrency-button" ng-click="close()">Continue Shopping</button>\n</div>\n<div ng-show="cart && cart.length">\n  <ul class="cart-products">\n    <li class="cart-product" ng-repeat="product in cart">\n      <div class="left">\n        <div class="name" ng-bind="product.name"></div>\n        <div class="quantity">Count: <input ng-model="product.qty" ng-change="updateQuantity(product)"></div>\n      </div>\n      <div class="right">\n        <div class="price"><span ng-bind="product.price/100 | currency"></span></div>\n        <div class="remove"><a href ng-click="removeProduct(product)">remove</a></div>\n      </div>\n    </li>\n    <li class="cart-product total">\n      <div class="left">Product Total</div>\n      <div class="right product-total">{{product_total/100 | currency}}</div>\n    </li>\n  </ul>\n  <button type="button" class="kurrency-button checkout-button" ng-click="toggle(\'checkout\', \'cart\')">Checkout</button>\n</div>'),a.put("kurrency-templates/menu/checkout-2.html",'<h1>Checkout</h1>\n<p>Please complete the form below to finish checkout</p>\n<div class="alerts">\n  <div ng-repeat="alert in messages[\'checkout\']" class="alert-{{alert.type}}">{{alert.message}}</div>\n</div>\n<form>\n  <div ng-show="addressList.length > 0">\n    <p>Select from a billing address you have saved</p>\n    <select class="kurrency-input" ng-model="checkout.billing.ship_to" ng-options="address as address.address.address_1 for address in addressList" ng-change="changedAddress()"><option value>New Address</option></select>\n  </div>\n  <div>\n    <button type="button" class="kurrency-button small" ng-click="copyShippingAddress()" ng-hide="shippingAddressCopied">Copy Shipping Address</button>\n  </div>\n  <div>\n    <p>Enter your email address</p>\n    <input class="kurrency-input" type="text" ng-model="checkout.billing.ship_to.email" placeholder="Your email address">\n  </div>\n  <div>\n    <p>Enter a billing address</p>\n    <input class="kurrency-input" type="text" ng-model="checkout.billing.ship_to.name" placeholder="Your Name">\n    <input class="kurrency-input" type="text" ng-model="checkout.billing.ship_to.company_name" placeholder="(optional) Company Name">\n    <input class="kurrency-input" type="text" ng-model="checkout.billing.ship_to.address.address_1" placeholder="Enter your address" ng-change="lookupGeoCode(checkout.billing.ship_to.address.address_1, checkout.billing.ship_to.address.postal_code, checkout.billing)">\n    <div ng-show="geocodeComplete">\n      <input class="kurrency-input" type="text" ng-model="checkout.billing.ship_to.address.address_2" placeholder="(optional) Address Line 2">\n      <input class="kurrency-input" type="text" ng-model="checkout.billing.ship_to.address.city" placeholder="Enter your city">\n      <select class="kurrency-input" ng-model="checkout.billing.ship_to.address.state_code" ng-options="state.value as state.name for state in stateList"><option value>Select a State</option></select>\n      <select class="kurrency-input" ng-model="checkout.billing.ship_to.address.country_code" ng-options="country.value as country.name for country in countryList"><option value>Select a Country</option></select>\n    </div>\n    <input class="kurrency-input" type="text" ng-model="checkout.billing.ship_to.address.postal_code" placeholder="Enter your postal/zip code" ng-change="lookupGeoCode(checkout.billing.ship_to.address.address_1, checkout.billing.ship_to.address.postal_code, checkout.billing)">\n  </div>\n  <button type="submit" class="kurrency-button contact-button" ng-click="toggle(\'checkout-3\', \'checkout-2\')">Continue</button>\n</form>'),a.put("kurrency-templates/menu/checkout-3.html",'<h1>Checkout</h1>\n<p>Please complete the form below to finish checkout</p>\n<div class="alerts">\n  <div ng-repeat="alert in messages[\'checkout\']" class="alert-{{alert.type}}">{{alert.message}}</div>\n</div>\n<form>\n  <div ng-show="requiresShipping">\n    <p>Select a shipping method</p>\n    <select class="kurrency-input" ng-model="selectedRate" ng-disabled="rates.length <= 0" ng-options="rate as ((rate.cost | currency) + \' - \' + rate.name) for rate in rates">\n      <option value="">Please Wait...</option>\n    </select>\n  </div>\n  <div ng-show="paymentMethodList.length > 0">\n    <p>Select a payment method</p>\n    <select class="kurrency-input" ng-model="checkout.payment_method" ng-options="payment_method as (getPaymentMethodType(payment_method) + \': \' + payment_method.nickname) for payment_method in paymentMethodList"><option value>New Credit Card</option></select>\n  </div>\n  <div ng-show="!checkout.payment_method || !checkout.payment_method._id">\n    <p>Enter your payment information</p>\n    <input class="kurrency-input" type="text" ng-model="checkout.payment_method.card.name" placeholder="Name on card">\n    <input class="kurrency-input" type="text" ng-model="checkout.payment_method.card.card_number" placeholder="Card number">\n    <select class="kurrency-input" class="expiration" ng-model="checkout.payment_method.card.expiration_month" ng-options="option.value as option.name for option in expirationMonths"><option value>Expiration Month</option></select>\n    <select class="kurrency-input" class="expiration" ng-model="checkout.payment_method.card.expiration_year" ng-options="option.value as option.name for option in expirationYears"><option value>Expiration Year</option></select>\n    <input class="kurrency-input" type="text" ng-model="checkout.payment_method.card.security_code" placeholder="Security code on back">\n  </div>\n  <div class="order-total">\n    <ul class="cart-products">\n      <li class="cart-product total">\n        <div class="left">Product Total</div>\n        <div class="right product-total">{{product_total/100 | currency}}</div>\n      </li>\n      <li class="cart-product total">\n        <div class="left">Tax Total</div>\n        <div class="right product-total">{{tax_total/100 | currency}}</div>\n      </li>\n      <li class="cart-product total">\n        <div class="left">Shipping Total</div>\n        <div class="right product-total">{{shipping_total/100 | currency}}</div>\n      </li>\n      <li class="cart-product final total">\n        <div class="left">Final Total</div>\n        <div class="right product-total">{{final_total/100 | currency}}</div>\n      </li>\n    </ul>\n  </div>\n  <button type="submit" class="kurrency-button contact-button" ng-click="completeOrder()">Complete Order</button>\n</form>'),a.put("kurrency-templates/menu/checkout-complete.html",'<h1>Order Complete!</h1>\n<p>Thank you for placing an order, you should receive an email confirmation soon</p>\n<button type="button" class="kurrency-button" ng-click="close()">Continue Shopping</button>'),a.put("kurrency-templates/menu/checkout.html",'<h1>Checkout</h1>\n<p>Please complete the form below to finish checkout</p>\n<div class="alerts">\n  <div ng-repeat="alert in messages[\'checkout\']" class="alert-{{alert.type}}">{{alert.message}}</div>\n</div>\n<form>\n  <div ng-show="!kurrency.auth.loggedIn()">\n    <p>Have an account?</p>\n    <button class="kurrency-button small" type="button" ng-click="toggle(\'login\', \'checkout\', \'checkout\')">Login Now</button>\n  </div>\n  <div ng-show="addressList.length > 0">\n    <p>Select from a shipping address you have saved</p>\n    <select class="kurrency-input" ng-model="checkout.shipment.ship_to" ng-options="address as address.address.address_1 for address in addressList" ng-change="changedAddress()"><option value>New Address</option></select>\n  </div>\n  <div>\n    <p>Enter your email address</p>\n    <input class="kurrency-input" type="text" ng-model="checkout.shipment.ship_to.email" placeholder="Your email address">\n  </div>\n  <div ng-show="requiresShipping">\n    <p>Enter a shipping address</p>\n    <input class="kurrency-input" type="text" ng-model="checkout.shipment.ship_to.name" placeholder="Your Name">\n    <input class="kurrency-input" type="text" ng-model="checkout.shipment.ship_to.company_name" placeholder="(optional) Company Name">\n    <input class="kurrency-input" type="text" ng-model="checkout.shipment.ship_to.address.address_1" placeholder="Enter your address" ng-change="lookupGeoCode(checkout.shipment.ship_to.address.address_1, checkout.shipment.ship_to.address.postal_code, checkout.shipment)">\n    <div ng-show="geocodeComplete">\n      <input class="kurrency-input" type="text" ng-model="checkout.shipment.ship_to.address.address_2" placeholder="(optional) Address Line 2">\n      <input class="kurrency-input" type="text" ng-model="checkout.shipment.ship_to.address.city" placeholder="Enter your city">\n      <select class="kurrency-input" ng-model="checkout.shipment.ship_to.address.state_code" ng-options="state.value as state.name for state in stateList"><option value>Select a State</option></select>\n      <select class="kurrency-input" ng-model="checkout.shipment.ship_to.address.country_code" ng-options="country.value as country.name for country in countryList"><option value>Select a Country</option></select>\n    </div>\n    <input class="kurrency-input" type="text" ng-model="checkout.shipment.ship_to.address.postal_code" placeholder="Enter your postal/zip code" ng-change="lookupGeoCode(checkout.shipment.ship_to.address.address_1, checkout.shipment.ship_to.address.postal_code, checkout.shipment)">\n  </div>\n  <button type="submit" class="kurrency-button contact-button" ng-click="saveAddress(checkout.shipment.ship_to); toggle(\'checkout-2\', \'checkout\')">Continue</button>\n</form>'),a.put("kurrency-templates/menu/contact.html",'<h1>Contact Us</h1>\n<p>Fill out the form below and we\'ll respond as soon as possible</p>\n<div class="alerts">\n  <div ng-repeat="alert in messages[\'contact\']" class="alert-{{alert.type}}">{{alert.message}}</div>\n</div>\n<form ng-submit="sendContact()">\n  <input class="kurrency-input" type="text" ng-model="contact.name" placeholder="Enter your name">\n  <input class="kurrency-input" type="email" ng-model="contact.email" placeholder="Enter your email">\n  <textarea rows="3" class="kurrency-input" ng-model="contact.message" placeholder="Enter a message or concern to send to us"></textarea>\n  <button type="submit" class="kurrency-button contact-button">Contact</button>\n</form>'),a.put("kurrency-templates/menu/forgot-password.html",'<h1>Forgot My Password</h1>\n<p>Enter your email address and we will send you instructions to reset your password</p>\n<div class="alerts">\n  <div ng-repeat="alert in messages[\'forgot-password\']" class="alert-{{alert.type}}">{{alert.message}}</div>\n</div>\n<form ng-submit="forgotPassword()">\n  <input class="kurrency-input" type="text" ng-model="forgot.email" placeholder="Enter your email address">\n  <button class="kurrency-button send-password-instructions" type="submit" class="login-button">Send Instructions</button>\n</form>'),a.put("kurrency-templates/menu/register.html",'<h1>Register</h1>\n<p>Enter the fields below to get started</p>\n<div class="alerts">\n  <div ng-repeat="alert in messages[\'register\']" class="alert-{{alert.type}}">{{alert.message}}</div>\n</div>\n<form ng-submit="registerUser()">\n  <input class="kurrency-input" type="text" ng-model="register.first_name" placeholder="Enter your first name">\n  <input class="kurrency-input" type="text" ng-model="register.last_name" placeholder="Enter your last name">\n  <input class="kurrency-input" type="email" ng-model="register.email" placeholder="Enter your email">\n  <input class="kurrency-input" type="password" ng-model="register.password" placeholder="Enter a password">\n  <button type="submit" class="kurrency-button register-button">Register</button>\n  <p>Already have an account?</p>\n  <button type="button" class="kurrency-button small login-button" ng-click="toggle(\'login\', \'register\')">Sign in now</button>\n</form>'),a.put("kurrency-templates/menu/sign-in.html",'<h1>Sign In</h1>\n<p>Sign into your Kurrency account.</p>\n<div class="alerts">\n  <div ng-repeat="alert in messages[\'login\']" class="alert-{{alert.type}}">{{alert.message}}</div>\n</div>\n<form ng-submit="loginUser()">\n  <input class="kurrency-input" type="text" ng-model="login.username" placeholder="Enter your username or email">\n  <input class="kurrency-input" type="password" ng-model="login.password" placeholder="Enter your password">\n  <button type="submit" class="kurrency-button login-button">Sign In</button>\n  <div class="spacer"></div>\n  <button type="button" class="kurrency-button small forgot-password" ng-click="toggle(\'forgot-password\', \'login\')">Forgot your password?</button>\n  <p>Don\'t have an account?</p>\n  <button type="button" class="kurrency-button small register-button" ng-click="toggle(\'register\', \'login\')">Register Now</button>\n</form>'),a.put("kurrency-templates/menu/wishlist.html",'<h1>Wishlist</h1>\n<div ng-show="!wishlist || !wishlist.length">\n  <p>You have nothing in your wishlist</p>\n  <button type="button" class="kurrency-button" ng-click="close()">Continue Shopping</button>\n</div>\n<div ng-show="wishlist && wishlist.length">\n  <ul>\n    <li ng-repeat="product in cart">\n\n    </li>\n  </ul>\n  <button type="button" class="kurrency-button share-wishlist-button" ng-click="toggle(\'share-wishlist\', \'wishlist\')">Share my wishlist</button>\n</div>')}]),a[KURRENCY_CONFIG.ANGULAR].module("KurrencyApp").constant("kurrencyConfig",{cache:!1,local:!1,accessToken:"ABC123",mode:"test",phrases:{cart_empty:"You don't have anything in your cart"},months:[{name:"January",value:1},{name:"February",value:2},{name:"March",value:3},{name:"April",value:4},{name:"May",value:5},{name:"June",value:6},{name:"July",value:7},{name:"August",value:8},{name:"September",value:9},{name:"October",value:10},{name:"November",value:11},{name:"December",value:12}],years:[{name:(new Date).getFullYear(),value:(new Date).getFullYear()},{name:(new Date).getFullYear()+1,value:(new Date).getFullYear()+1},{name:(new Date).getFullYear()+2,value:(new Date).getFullYear()+2},{name:(new Date).getFullYear()+3,value:(new Date).getFullYear()+3},{name:(new Date).getFullYear()+4,value:(new Date).getFullYear()+4},{name:(new Date).getFullYear()+5,value:(new Date).getFullYear()+5},{name:(new Date).getFullYear()+6,value:(new Date).getFullYear()+6},{name:(new Date).getFullYear()+7,value:(new Date).getFullYear()+7}],states:[{name:"Alberta",value:"AB"},{name:"Alabama",value:"AL"},{name:"Alaska",value:"AK"},{name:"American Samoa",value:"AS"},{name:"Arizona",value:"AZ"},{name:"Arkansas",value:"AR"},{name:"British Columbia",value:"BC"},{name:"California",value:"CA"},{name:"Colorado",value:"CO"},{name:"Connecticut",value:"CT"},{name:"Delaware",value:"DE"},{name:"District Of Columbia",value:"DC"},{name:"Federated States Of Micronesia",value:"FM"},{name:"Florida",value:"FL"},{name:"Georgia",value:"GA"},{name:"Guam",value:"GU"},{name:"Hawaii",value:"HI"},{name:"Idaho",value:"ID"},{name:"Illinois",value:"IL"},{name:"Indiana",value:"IN"},{name:"Iowa",value:"IA"},{name:"Kansas",value:"KS"},{name:"Kentucky",value:"KY"},{name:"Louisiana",value:"LA"},{name:"Manitoba",value:"MB"},{name:"Maine",value:"ME"},{name:"Marshall Islands",value:"MH"},{name:"Maryland",value:"MD"},{name:"Massachusetts",value:"MA"},{name:"Michigan",value:"MI"},{name:"Minnesota",value:"MN"},{name:"Mississippi",value:"MS"},{name:"Missouri",value:"MO"},{name:"Montana",value:"MT"},{name:"New Brunswich",value:"NB"},{name:"Nebraska",value:"NE"},{name:"Newfoundland and Labrador",value:"NL"},{name:"Nevada",value:"NV"},{name:"New Hampshire",value:"NH"},{name:"New Jersey",value:"NJ"},{name:"New Mexico",value:"NM"},{name:"New York",value:"NY"},{name:"North Carolina",value:"NC"},{name:"North Dakota",value:"ND"},{name:"Nova Scotia",value:"NS"},{name:"Northern Mariana Islands",value:"MP"},{name:"Ohio",value:"OH"},{name:"Oklahoma",value:"OK"},{name:"Ontario",value:"ON"},{name:"Oregon",value:"OR"},{name:"Palau",value:"PW"},{name:"Pennsylvania",value:"PA"},{name:"Prince Edward Island",value:"PE"},{name:"Puerto Rico",value:"PR"},{name:"Quebec",value:"QB"},{name:"Rhode Island",value:"RI"},{name:"South Carolina",value:"SC"},{name:"South Dakota",value:"SD"},{name:"Saskatchewan",value:"SK"},{name:"Tennessee",value:"TN"},{name:"Texas",value:"TX"},{name:"Utah",value:"UT"},{name:"Vermont",value:"VT"},{name:"Virgin Islands",value:"VI"},{name:"Virginia",value:"VA"},{name:"Washington",value:"WA"},{name:"West Virginia",value:"WV"},{name:"Wisconsin",value:"WI"},{name:"Wyoming",value:"WY"},{name:"Yukon",value:"YT"}],countries:[{name:"United States",value:"US"},{name:"Canada",value:"CA"}]}).factory("kurrency",["$rootScope","$http","kurrencyConfig",function(b,c,d){function e(d,e){var f=this;if(f.options={},!d)return console.log("Missing Kurrency object");var g={type:"get",url:"",path:"",baseUrl:d.options.baseUrl||"",data:{},dataType:"json",headers:{"Access-Token":d.options.accessToken,"Authentication-Key":d.options.authenticationKey?d.options.authenticationKey:void 0,"Session-Id":d.options.session?d.options.session._id:void 0,"Kurrency-Mode":d.options.mode?d.options.mode:"test"},commonError:function(a){console.log(a)}};return f.cleanData=function(b){if(!b)return b;var c=a[KURRENCY_CONFIG.ANGULAR].copy(b);if("object"!=typeof c)return c;for(var d in c)"$"===d.charAt(0)&&"$or"!==d&&"$not"!==d&&"$ne"!==d&&"$and"!==d&&"$gt"!==d&&"$gte"!==d&&"$lt"!==d&&"$gte"!==d&&"$in"!==d&&"$nin"!==d&&"$exists"!==d&&"$type"!==d&&"$mod"!==d&&"$regex"!==d&&"$text"!==d&&"$where"!==d&&"$geoIntersects"!==d&&"$geoWithin"!==d&&"$nearSphere"!==d&&"$near"!==d&&"$box"!==d&&"$centerSphere"!==d&&"$center"!==d&&"$geometry"!==d&&"$maxDistance"!==d&&"$minDistance"!==d&&"$polygon"!==d&&"$uniqueDocs"!==d&&"$all"!==d&&"$elemMatch"!==d&&"$size"!==d&&"$meta"!==d&&"$slice"!==d&&delete c[d],"object"==typeof c[d]&&(c[d]=f.cleanData(c[d]));return c},f.config=function(b){return f.options=a[KURRENCY_CONFIG.ANGULAR].extend({},g,b),f},f.req=function(e,g,h,i){b.$broadcast("apiLoading",!0);var j=a[KURRENCY_CONFIG.ANGULAR].extend({},f.options);d.options.user&&(j.headers["authentication-key"]=d.options.user.authenticationKey),j.method=e,j.url=g,h&&(h=f.cleanData(h)),"post"===e||"put"===e?(j.data=JSON.stringify(h),j.contentType="application/json"):j.params=h;var k=c(j);return k.success(function(){b.$broadcast("apiLoading",!1)}),k.error(function(a){return b.$broadcast("apiLoading",!1),b.$broadcast("apiError",a),i?i(a):void 0}),k},f.get=function(a,b,c){return"function"==typeof b&&(c=b,b=null),f.req("get",a,b,c)},f.post=function(a,b,c){return"function"==typeof b&&(c=b,b=null),f.req("post",a,b,c)},f.put=function(a,b,c){return"function"==typeof b&&(c=b,b=null),f.req("put",a,b,c)},f.del=function(a,b,c){return"function"==typeof b&&(c=b,b=null),f.req("delete",a,b,c)},f.config(e)}function f(){var a=this;return"undefined"!=typeof Storage?(a.set=function(a,b){return"object"!=typeof b?(sessionStorage[a]=b,sessionStorage[a]):(sessionStorage[a]=JSON.stringify(b),sessionStorage[a])},a.get=function(a){var b;try{b=JSON.parse(sessionStorage[a])}catch(c){b=sessionStorage[a]}return b},a.remove=function(a){return delete sessionStorage[a],null}):(a.set=function(a,b){var c="",d="object"==typeof b?JSON.stringify(b):escape(b);document.cookie=escape(a)+"="+d+c+"; path=/"},a.get=function(a){for(var b=escape(a)+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(b)){var f;try{f=JSON.parse(e.substring(b.length,e.length))}catch(g){f=decodeURIComponent(e.substring(b.length,e.length))}return f}}return null},a.remove=function(b){a.create(b,"",-1)}),a}var g=function(c){function d(a){a&&t.config(a)}function g(a){a&&t.config(a)}function h(a){a&&t.config(a)}function i(a){a&&t.config(a)}function j(a){a&&t.config(a)}function k(a){a&&t.config(a)}function l(a){a&&t.config(a)}function m(a){a&&t.config(a)}function n(a){a&&t.config(a)}function o(b){var c=this;return c.rate=null,c.ship_to={name:void 0,company_name:void 0,attention_to:void 0,email:void 0,phone:void 0,address:{address_1:void 0,address_2:void 0,address_3:void 0,city:void 0,postal_code:void 0,state_code:void 0,country_code:"US"}},c.setRate=function(a){return c.rate=a,c},c.setShipTo=function(a){return c.ship_to.name=a.name,c.ship_to.company_name=a.company_name,c.ship_to.attention_to=a.attention_to,c.ship_to.email=a.email,c.ship_to.phone=a.phone,a.address&&(c.ship_to.address=a.address),c},c.setAddress=function(a){c.ship_to.address=a},c=a[KURRENCY_CONFIG.ANGULAR].extend(c,b)}function p(b){var c=this;return c._id=void 0,c.ship_to={name:void 0,company_name:void 0,attention_to:void 0,email:void 0,phone:void 0,address:{address_1:void 0,address_2:void 0,address_3:void 0,city:void 0,postal_code:void 0,state_code:void 0,country_code:"US"}},c.setShipTo=function(a){return c.ship_to.name=a.name,c.ship_to.company_name=a.company_name,c.ship_to.attention_to=a.attention_to,c.ship_to.email=a.email,c.ship_to.phone=a.phone,a.address&&(c.ship_to.address=a.address),c},c.setAddress=function(a){c.ship_to.address=a},c=a[KURRENCY_CONFIG.ANGULAR].extend(c,b)}function q(b){var c=this;return c.type="credit_card",c.card={},c.bank_account={},c=a[KURRENCY_CONFIG.ANGULAR].extend(c,b)}function r(b){var c=new q({type:"credit_card"});return c._id=void 0,c.card.name=void 0,c.card.card_number=void 0,c.card.expiration_month=(new Date).getMonth()+1,c.card.expiration_year=(new Date).getFullYear(),c.card.security_code=void 0,c.card.postal_code=void 0,c=a[KURRENCY_CONFIG.ANGULAR].extend(c,b)}function s(b){var c=new q({type:"bank_account"});return c._id=void 0,c.bank_account.name=void 0,c.bank_account.account_number=void 0,c.bank_account.routing_number=void 0,c.bank_account.type="checking",c=a[KURRENCY_CONFIG.ANGULAR].extend(c,b)}var t=this;t.options={},t.Stor=f,t.Request=e;var u=t.storage=new t.Stor,v=t.baseUrls={test:"http://0.0.0.0:3458/jsapi",production:"https://api.kurrency.io/api/jsapi"},w={products:{},product_lines:{}};if(!window.angular)throw Error("angular is missing");var x={caching:!0,local:!1,accessToken:"",authenticationKey:null,session:null,user:null,mode:"test",baseUrl:v[this.local?"test":"production"]};return t.config=function(b){return t.options=a[KURRENCY_CONFIG.ANGULAR].extend(x,b),t.options.baseUrl=t.options.local?v.test:v.production,t.options.user=u.get("user"),t},t.handleError=function(a){a&&403===a.responseCode&&(u.remove("session"),t.options.session=null),b.$broadcast("kurrencyError",a)},d.prototype.get=function(a,b){if(!a)return t.options.session;if(t.options.session=u.get("session"),t.options.session&&!b)return a(null,t.options.session);var c=new e(t).get(t.options.baseUrl+"/session",null,t.handleError);c.success(function(b){return t.options.session=b.pkg.data,u.set("session",t.options.session),a(null,t.options.session)})},d.prototype.save=function(a,b){t.options.session=a;var c=new e(t).post(t.options.baseUrl+"/session",a.data,t.handleError);c.success(function(a){return t.options.session=a.pkg.data,u.set("session",t.options.session),b(null,t.options.session)})},g.prototype.get=function(a){t.session.get(function(b,c){return c.data.cart?a(null,c.data.cart):(c.data.cart=[],void t.session.save(c,function(b,c){return a(null,c.data.cart)}))})},g.prototype.add=function(a,b,c){t.cart.get(function(d,e){for(var f=0;f<e.length;f++)if(e[f]._id===a._id)return e[f].qty+=parseInt(b,10),t.session.get(function(a,b){b.data.cart=e,t.session.save(b,function(){return c(null,e)})});e.push({_id:a._id,name:a.name,sub_title:a.sub_title,qty:parseInt(b,10),image:a.images[0],weight:a.weight,dimensions:a.dimensions,price:a.price,product_lines:a.product_lines,requires_shipping:a.requires_shipping,allow_presale:a.allow_presale,taxable:a.taxable,variants:a.variants}),t.session.get(function(a,b){b.data.cart=e,t.session.save(b,function(){return c(null,e)})})})},g.prototype.update=function(a,b,c){t.cart.get(function(d,e){for(var f=0;f<e.length;f++)if(e[f]._id===a._id){e[f].qty=parseInt(b);break}t.session.get(function(a,b){b.data.cart=e,t.session.save(b,function(){return c(null,e)})})})},g.prototype.remove=function(a,b){t.cart.get(function(c,d){for(var e=0;e<d.length;e++)if(d[e]._id===a._id){d.splice(e,1);break}t.session.get(function(a,c){c.data.cart=d,t.session.save(c,function(){return b(null,d)})})})},g.prototype.empty=function(a){t.session.get(function(b,c){c.data.cart=[],t.session.save(c,function(){return a(null,[])})})},g.prototype.replace=function(a,b){t.session.get(function(c,d){d.data.cart=a,t.session.save(d,function(a,c){return a?b(a,null):b(null,c.data.cart)})})},h.prototype.register=function(a,c){var f=new e(t).post(t.options.baseUrl+"/register",a,t.handleError);
f.success(function(a){d.user_id=a.pkg.data._id,t.session.get(function(){return t.auth.setUser(a.pkg.data),b.$broadcast("kurrencyRegistered",a.pkg.data),c(null,a.pkg.data)},!0)})},h.prototype.login=function(a,c,d){var f=new e(t).post(t.options.baseUrl+"/login",{username:a,password:c},t.handleError);f.success(function(a){t.session.get(function(){return t.auth.setUser(a.pkg.data),b.$broadcast("kurrencySignIn",a.pkg.data),d(null,a.pkg.data)},!0)})},h.prototype.forgotPassword=function(a,c){var d=new e(t).post(t.options.baseUrl+"/forgot-password",{email:a},t.handleError);d.success(function(a){return b.$broadcast("kurrencyForgotPassword",a),c(null,a)})},h.prototype.signOut=function(){u.remove("session"),u.remove("user"),t.options.session=null,t.options.user=null,b.$broadcast("kurrencySignOut",!0)},h.prototype.loggedIn=function(){return u.get("user")},h.prototype.setUser=function(a){return u.set("user",a),t.options.user=a,a},i.prototype.list=function(a){t.session.get(function(){var b=new e(t).get(t.options.baseUrl+"/addresses",null,t.handleError);b.success(function(b){return a(null,b.pkg.data)})})},i.prototype.create=function(a,b){t.session.get(function(){var c=new e(t).post(t.options.baseUrl+"/addresses",a,t.handleError);c.success(function(a){return b(null,a.pkg.data)})})},i.prototype.edit=function(a,b){t.session.get(function(){var c=new e(t).put(t.options.baseUrl+"/addresses",a,t.handleError);c.success(function(a){return b(null,a.pkg.data)})})},i.prototype.remove=function(a,b){t.session.get(function(){var c=new e(t).del(t.options.baseUrl+"/addresses",a,t.handleError);c.success(function(a){return b(null,a.pkg.data)})})},j.prototype.list=function(a){t.session.get(function(){var b=new e(t).get(t.options.baseUrl+"/transaction-accounts",null,t.handleError);b.success(function(b){return a(null,b.pkg.data)})})},j.prototype.create=function(a,b){t.session.get(function(){var c=new e(t).post(t.options.baseUrl+"/transaction-accounts",a,t.handleError);c.success(function(a){return b(null,a.pkg.data)})})},j.prototype.edit=function(a,b){t.session.get(function(){var c=new e(t).put(t.options.baseUrl+"/transaction-accounts",a,t.handleError);c.success(function(a){return b(null,a.pkg.data)})})},j.prototype.remove=function(a,b){t.session.get(function(){var c=new e(t).del(t.options.baseUrl+"/transaction-accounts",a,t.handleError);c.success(function(a){return b(null,a.pkg.data)})})},k.prototype.list=function(a,b){t.session.get(function(){var c=JSON.stringify(a);if(w.products[c])return b(null,w.products[c]);var d=new e(t).get(t.options.baseUrl+"/products",a,t.handleError);d.success(function(a){return t.options.caching===!0&&(w.products[c]=a.pkg.data),b(null,a.pkg.data)})})},l.prototype.list=function(a,b){t.session.get(function(){var c=JSON.stringify(a);if(w.product_lines[c])return b(null,w.product_lines[c]);var d=new e(t).get(t.options.baseUrl+"/product-lines",a,t.handleError);d.success(function(a){return t.options.caching===!0&&(w.product_lines[c]=a.pkg.data),b(null,a.pkg.data)})})},m.prototype.list=function(a,b){t.session.get(function(){var c=new e(t).get(t.options.baseUrl+"/orders",a,t.handleError);c.success(function(a){return b(null,a.pkg.data)})})},m.prototype.create=function(a,b){t.session.get(function(){var c=new e(t).post(t.options.baseUrl+"/orders",a,t.handleError);c.success(function(a){return b(null,a.pkg.data)})})},m.prototype.taxes=function(a,b,c){var d={value:a,ship_to:b.ship_to};t.session.get(function(a){if(a)return c(a,null);var b=new e(t).post(t.options.baseUrl+"/orders/taxes",d,t.handleError);b.success(function(a){return c(null,a.pkg.data)})})},n.prototype.rates=function(b,c){if(!b.products)return c(new Error("Missing products"),null);var d=a[KURRENCY_CONFIG.ANGULAR].copy(b);delete d.products,d.packages=[{weight:0,price:0}];for(var f=0;f<b.products.length;f++)d.packages[0].weight+=b.products[f].weight*b.products[f].qty,d.packages[0].price+=b.products[f].price*b.products[f].qty;t.session.get(function(){var a=new e(t).post(t.options.baseUrl+"/shipping/rates",d,t.handleError);a.success(function(a){var b=a.pkg.data;return b.sort(function(a,b){return a.cost-b.cost}),c(null,b)})})},t.session=new d,t.cart=new g,t.auth=new h,t.addresses=new i,t.payment_methods=new j,t.products=new k,t.product_lines=new l,t.orders=new m,t.shipping=new n,t.shipment=o,t.customer=p,t.credit_card=r,t.bank_account=s,t.config(c)};return new g(d)}]).config(function(a){a.enabled(!1)}).factory("kurrencyMenuService",["kurrency","kurrencyConfig","$rootScope",function(b,c,d){var e=this;return e.menu=[],e.cart=[],e.sidebars=[],e.showing=null,e.back=null,e.next=null,b.cart.get(function(a,b){e.cart=b}),d.$on("cartUpdated",function(a,b){e.cart=b}),e.close=function(){e.showing=null,d.$broadcast("menuClosed",!0)},e.toggle=function(a,b,c){e.showing=e.showing===a?null:a,e.back=b?b:null,e.next=c?c:null,d.$broadcast("menuToggled",{val:a,back:b,next:c})},e.show=function(a){return a===e.showing},e.addMenuItem=function(b,c){c||(c=e.menu.length);var d={name:null,tag:null,uri:null,buttonTemplateUrl:"kurrency-templates/menu/button.html",showLoggedIn:!1,showLoggedOut:!1,onClick:null};return b=a[KURRENCY_CONFIG.ANGULAR].extend({},d,b),e.menu.splice(c,0,b),e},e.addSidebar=function(b){var c={tag:null,className:null,templateUrl:null};return b=a[KURRENCY_CONFIG.ANGULAR].extend({},c,b),e.sidebars.push(b),e},e.getUri=function(a){return a.uri&&a.uri.length>0?a.uri:null},e.checkShowing=function(a){var c=b.auth.loggedIn();return c&&a.showLoggedIn?!0:!c&&a.showLoggedOut?!0:!1},e.clearMenu=function(){return e.menu=[],e},e.clearSidebar=function(){return e.sidebars=[],e},e.checkClass=function(a){return e.showing===a?{active:!0}:""},e.checkButtonClass=function(a){if("cart"===a.tag)return e.cart&&e.cart.length?{cart:!0,"cart-empty":e.cart.length<=0}:{cart:!0,"cart-empty":!0};var b={};return b[a.tag]=!0,b},e.addSidebar({tag:"login",className:"kurrency-login",templateUrl:"kurrency-templates/menu/sign-in.html"}).addSidebar({tag:"account",className:"kurrency-account",templateUrl:"kurrency-templates/menu/account.html"}).addSidebar({tag:"cart",className:"kurrency-cart",templateUrl:"kurrency-templates/menu/cart.html"}).addSidebar({tag:"checkout",className:"kurrency-checkout",templateUrl:"kurrency-templates/menu/checkout.html"}).addSidebar({tag:"checkout-2",className:"kurrency-checkout",templateUrl:"kurrency-templates/menu/checkout-2.html"}).addSidebar({tag:"checkout-3",className:"kurrency-checkout",templateUrl:"kurrency-templates/menu/checkout-3.html"}).addSidebar({tag:"checkout-complete",className:"kurrency-checkout",templateUrl:"kurrency-templates/menu/checkout-complete.html"}).addSidebar({tag:"forgot-password",className:"kurrency-forgot-password",templateUrl:"kurrency-templates/menu/forgot-password.html"}).addSidebar({tag:"register",className:"kurrency-register",templateUrl:"kurrency-templates/menu/register.html"}),e.addMenuItem({name:"Sign In",tag:"login",icon:"kicon-login",template:"kurrency-templates/menu/sign-in.html",showLoggedIn:!1,showLoggedOut:!0}).addMenuItem({name:"Account",tag:"account",icon:"kicon-account",template:"kurrency-templates/menu/account.html",showLoggedIn:!0,showLoggedOut:!1}).addMenuItem({name:"Shopping Cart",tag:"cart",buttonTemplateUrl:"kurrency-templates/menu/button-cart.html",template:"kurrency-templates/menu/cart.html",showLoggedIn:!0,showLoggedOut:!0}),e.addMenuItem({name:"Sign Out",tag:"sign-out",icon:"kicon-sign_out",onClick:function(){b.auth.signOut()},showLoggedIn:!0,showLoggedOut:!1}),e}]).directive("kurrencyPopover",function(){return{scope:{kurrencyPopover:"=",showing:"@"},restrict:"A",transclude:!0,templateUrl:function(a,b){var c="kurrency-templates/kurrency-popover.html";return b.templateUrl&&(c=b.templateUrl),c},link:function(b,c){var d=a[KURRENCY_CONFIG.ANGULAR].element(c[0].querySelector(".kurrency-popover"));c.bind("mouseover",function(){b.showing=!0,b.$apply()}),c.bind("mouseout",function(){b.showing=!1,b.$apply()}),b.$watch(function(){return b.showing},function(){b.showing="true"===b.showing||b.showing===!0,b.showing===!0?d.addClass("active"):d.removeClass("active")},!0)}}}).directive("kurrencyImage",["kurrency","kurrencyConfig","$parse",function(a,b){return{restrict:"E",scope:{src:"=",options:"@",alt:"="},template:'<img ng-src="{{newSrc}}" alt="{{alt}}">',link:function(c,d,e){function f(c,d){var e=b.local?a.baseUrls.test:a.baseUrls.production,f=e+"/imager?access-token="+b.accessToken+"&url="+encodeURIComponent(c);return d.size&&(f+="&size="+d.size),d.effect&&(f+="&effect="+d.effect),f}c.newSrc=null,e.$observe("options",function(a){c.options=c.$eval(a)}),c.$watch("src",function(){c.src&&(c.newSrc=f(c.src,c.options))})}}}]).directive("kurrencyProduct",["kurrency","kurrencyConfig",function(a,b){return{restrict:"E",scope:{id:"="},templateUrl:function(a,b){var c="kurrency-templates/kurrency-product.html";return b.templateUrl&&(c=b.templateUrl),c},replace:!0,link:function(c){c.kurrency=a,c.config=b,c.product=null,c.variants=[],a.products.list({_id:c.id},function(a,b){c.product=b[0]}),c.setVariant=function(a,b){for(var d=0;d<c.variants.length;d++)if(c.variants[d].name===a)return null===b?void c.variants.splice(d,1):void(c.variants[d].value=b.name);c.variants.push({name:a,value:b.name})},c.addToCart=function(b,d){c.variants.length&&(b.variants=c.variants),a.cart.add(b,d,function(a,b){return a?console.log(a):void c.$emit("cartUpdated",b)})}}}}]).directive("kurrencyMenu",["kurrency","kurrencyConfig","kurrencyMenuService","$timeout","$window","$document",function(c,d,e,f,g,h){return{restrict:"E",templateUrl:function(a,b){var c="kurrency-templates/kurrency-menu.html";return b.templateUrl&&(c=b.templateUrl),c},replace:!0,link:function(i){if(i.config=d,i.menuService=e,i.cart=null,i.wishlist=null,i.apiLoading=0,i.product_total=0,i.quantity_total=0,i.paymentEnabled=!1,i.requiresShipping=!1,i.addressList=[],i.paymentMethodList=[],i.checkout={service_carrier:null,service_code:null,shipment:new c.customer,billing:new c.customer,payment_method:new c.credit_card,products:null,notes:""},i.geocodeComplete=!1,i.stateList=d.states,i.countryList=d.countries,i.expirationMonths=d.months,i.expirationYears=d.years,i.shippingAddressCopied=!1,i.rates=[],i.selectedRate=null,i.tax_total=0,i.shipping_total=0,i.final_total=0,i.cartAddText=d.cartAddText?d.cartAddText:"Added to cart",i.shoppingCartPopoverText="Shopping Cart",i.cartAddActive=!1,i.order=null,!g.google){for(var j=h[0].getElementsByTagName("script"),k=!1,l=0;l<j.length;l++)j[l].src.indexOf("maps.googleapis")>-1&&(k=!0);if(!k){var m=b.createElement("script");m.type="text/javascript",m.async=!0,m.src="//maps.googleapis.com/maps/api/js?v=3.exp&key=AIzaSyDfl3BRqXwFWerx20m00Hec6mSFyL42w0Y&callback=initialize",b.getElementsByTagName("body")[0].appendChild(m)}}i.messages={none:[],login:[],"forgot-password":[],register:[],checkout:[],"checkout-2":[],"checkout-3":[],wishlist:[],contact:[],account:[]},i.kurrency=c,i.updateProductTotal=function(){i.product_total=0,i.quantity_total=0;for(var a,b=0;b<i.cart.length;b++)i.cart[b].requires_shipping&&(i.requiresShipping=!0),i.quantity_total+=parseInt(i.cart[b].qty,10),a=parseInt(i.cart[b].qty,10)*i.cart[b].price,i.product_total+=a},c.cart.get(function(a,b){i.cart=b,i.updateProductTotal()}),i.updateFinalTotal=function(){i.final_total=i.product_total+i.shipping_total+i.tax_total},i.$on("cartUpdated",function(a,b){var c=i.shoppingCartPopoverText;i.shoppingCartPopoverText=i.cartAddText,i.cartAddActive=!0,function(a){f(function(){i.shoppingCartPopoverText=a,i.cartAddActive=!1},3e3),i.cart=b,i.updateProductTotal()}(c)}),i.updateQuantity=function(a){i.updateProductTotal(),c.cart.update(a,a.qty,function(a,b){i.cart=b})},i.removeProduct=function(a){c.cart.remove(a,function(a,b){i.cart=b,i.updateProductTotal()})},i.saveAddress=function(a){i.wipeMessages();var b=c.auth.loggedIn();b&&(a._id&&c.addresses.edit(a,function(){i.getUserDetails()}),c.addresses.create(a,function(){i.getUserDetails()}))},i.deleteAddress=function(a){c.addresses.remove({_id:a._id},function(a){return a?console.log(a):void i.getUserDetails()})},i.savePaymentMethod=function(a){i.wipeMessages();var b=c.auth.loggedIn();b&&a._id&&c.payment_methods.edit(a,function(){i.getUserDetails()})},i.getPaymentMethodType=function(a){return"credit_card"===a.type?"Credit Card":"bank_account"===a.type?"Bank Account":"credit_line"===a.type?"Credit Line":void 0},i.deletePaymentMethod=function(a){c.payment_methods.remove({_id:a._id},function(a){return a?console.log(a):void i.getUserDetails()})},i.copyShippingAddress=function(){i.checkout.billing.ship_to=a[KURRENCY_CONFIG.ANGULAR].extend(i.checkout.billing.ship_to,i.checkout.shipment.ship_to),i.shippingAddressCopied=!0},i.lookupGeoCode=function(a,b,c){if(b&&!(b.length<5)){if(!g.google)return i.geocodeComplete=!0;var d=new google.maps.Geocoder;d.geocode({address:a+" "+b},function(a,b){if(b!==google.maps.GeocoderStatus.OK)return i.geocodeComplete=!0;console.log(a);for(var d=0;d<a[0].address_components.length;d++){var e=a[0].address_components[d];"locality"===e.types[0]&&(c.ship_to.address.city=e.long_name),"administrative_area_level_1"===e.types[0]&&(c.ship_to.address.state_code=e.short_name),"country"===e.types[0]&&(c.ship_to.country_code=e.short_name)}i.geocodeComplete=!0,i.$apply()})}},i.getTaxes=function(){c.orders.taxes(i.product_total,{ship_to:{address:{postal_code:i.checkout.shipment.ship_to.address.postal_code}}},function(a,b){i.tax_total=b,i.updateFinalTotal()})},i.getRates=function(){!i.checkout.shipment.ship_to.address.postal_code||i.checkout.shipment.ship_to.address.postal_code.length<5||c.shipping.rates({ship_to:{address:{address_1:i.checkout.shipment.ship_to.address.address_1,state_code:i.checkout.shipment.ship_to.address.state_code,country_code:i.checkout.shipment.ship_to.address.country_code,postal_code:i.checkout.shipment.ship_to.address.postal_code}},products:i.cart},function(a,b){return a?console.log(a):(i.rates=b,i.selectedRate=i.rates[0],void i.updateFinalTotal())})},i.getUserDetails=function(){var a=c.auth.loggedIn();a&&(i.checkout.shipment.ship_to.name=a.first_name+" "+a.last_name,i.checkout.shipment.ship_to.email=a.email,i.checkout.shipment.ship_to.phone=a.phone,c.addresses.list(function(a,b){b.length&&(i.addressList=b,i.checkout.shipment.ship_to=b[0],i.geocodeComplete=!0)}),c.payment_methods.list(function(a,b){i.paymentMethodList=b}))},i.changedAddress=function(){i.geocodeComplete=!0},i.$on("kurrencySignIn",function(){i.getUserDetails()}),c.auth.loggedIn()&&i.getUserDetails(),i.$on("kurrencyRegistered",function(){i.getUserDetails()}),i.$watch("selectedRate",function(){i.selectedRate&&(i.shipping_total=100*i.selectedRate.cost,i.checkout.service_carrier=i.selectedRate.carrier,i.checkout.service_code=i.selectedRate.code,i.updateFinalTotal())},!0),i.completeOrder=function(){return i.apiLoading>0?void i.addMessage("error","Please wait, we are processing your order"):void c.orders.create({service_carrier:i.checkout.service_carrier,service_code:i.checkout.service_code,ship_to:i.checkout.shipment.ship_to,customer:i.checkout.billing.ship_to,payment_method:i.checkout.payment_method,products:a[KURRENCY_CONFIG.ANGULAR].copy(i.cart),notes:""},function(a,b){return a?console.log(a):(i.order=b,void c.cart.empty(function(a,b){i.cart=b,i.toggle("checkout-complete")}))})},i.addMessage=function(a,b){var c=i.showing;c||(c="none"),i.messages[c].push({type:a,message:b})},i.wipeMessages=function(){for(var a in i.messages)i.messages[a]=[]},i.resetForms=function(){i.login={username:null,password:null},i.register={first_name:null,last_name:null,email:null,password:null},i.forgot={email:null},i.contact={name:null,email:null,phone:null,message:null}},i.loginUser=function(a){i.wipeMessages(),c.auth.login(i.login.username,i.login.password,function(){i.addMessage("success","Successfully logged in"),f(function(){i.next?i.toggle(i.next):i.showing=a?a:null,i.wipeMessages()},500)})},i.registerUser=function(a){i.wipeMessages(),i.register.confirm_password=i.register.password,c.auth.register(i.register,function(){i.addMessage("success","Account registered, and logged in"),f(function(){i.showing=a?a:null,i.wipeMessages()},500)})},i.forgotPassword=function(){i.wipeMessages(),c.auth.forgotPassword(i.forgot.email,function(){i.addMessage("success","Instructions sent to your email, go check it")})},i.$on("kurrencyError",function(a,b){return console.log(b),b.pkg?void i.addMessage("error",b.pkg.statusMessage):i.addMessage("error","An error occurred connecting to Kurrency's servers, check your connection.")}),i.$on("kurrencySignOut",function(){i.showing=null,i.paymentMethodList=[],i.addressList=[],c.cart.get(function(a,b){i.cart=b,i.updateProductTotal()}),i.checkout={service_carrier:null,service_code:null,shipment:new c.customer,billing:new c.customer,payment_method:new c.credit_card,products:null,notes:""}}),i.$on("apiLoading",function(a,b){b===!0?i.apiLoading++:i.apiLoading>0&&i.apiLoading--}),i.$on("menuToggled",function(a,b){i.wipeMessages(),i.resetForms(),"checkout-3"===b.val&&(i.getRates(),i.getTaxes())}),i.resetForms()}}}]),a.KURRENCY_CONFIG&&(a.KURRENCY_CONFIG.integrated||(a[KURRENCY_CONFIG.ANGULAR].injector(["ng","KurrencyApp"]).invoke(["$compile","$rootScope","kurrency","kurrencyConfig","kurrencyMenuService",function(c,d,e,f){f.cache=a.KURRENCY_CONFIG.CACHE?a.KURRENCY_CONFIG.CACHE:!0,f.accessToken=a.KURRENCY_CONFIG.ACCESS_TOKEN,f.mode=a.KURRENCY_CONFIG.MODE?a.KURRENCY_CONFIG.MODE:"test",f.local=a.KURRENCY_CONFIG.LOCAL?a.KURRENCY_CONFIG.LOCAL:!1;var g=a[KURRENCY_CONFIG.ANGULAR].element(b).find("body");f.accessToken&&g.append("<kurrency-menu></kurrency-menu>");var h=a[KURRENCY_CONFIG.ANGULAR].element(b).injector();b.querySelectorAll("[ng-app]").length||h||a[KURRENCY_CONFIG.ANGULAR].bootstrap(g[0],["KurrencyApp"])}]),a.KURRENCY_CONFIG.GOOGLE_FONTS&&a.KURRENCY_CONFIG.GOOGLE_FONTS!==!0||(a.WebFontConfig={google:{families:["Questrial::latin"]}},function(){var a=document.createElement("script");a.src=("https:"==document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js",a.type="text/javascript",a.async="true";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}()))),a.initialize=function(){}}if(a.KURRENCY_CONFIG?a.KURRENCY_CONFIG.ANGULAR||(a.KURRENCY_CONFIG.ANGULAR="angular"):a.KURRENCY_CONFIG={ANGULAR:"angular",MENU:{}},a[a.KURRENCY_CONFIG.ANGULAR]||"undefined"!=typeof a.KURRENCY_CONFIG.REQUIRE_ANGULAR&&a.KURRENCY_CONFIG.REQUIRE_ANGULAR!==!0)c();else{var d=b.createElement("script");d.type="text/javascript",d.async=!0,d.src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.25/angular.min.js",b.getElementsByTagName("body")[0].appendChild(d),d.readyState?d.onreadystatechange=function(){("loaded"==script.readyState||"complete"==script.readyState)&&(script.onreadystatechange=null,c())}:d.onload=function(){c()}}}(window,document);